<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Agentic Vision ‚Äî AI clothing analysis and virtual try-on with self-verification">
    <title>Agentic Vision ‚Äî AI Clothing Transfer</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>">
</head>

<body>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo-icon">üëÅÔ∏è</div>
            <div>
                <h1>Agentic Vision + Nano Banana</h1>
                <p class="header-sub">AI-Powered Clothing Analysis & Transfer with Self-Verification</p>
            </div>
        </div>
        <div class="header-badges">
            <span class="badge badge-purple">Gemini 3 Flash</span>
            <span class="badge badge-pink">Virtual Try-On</span>
            <span class="badge badge-green">Auto-Verify</span>
        </div>
    </header>

    <!-- Status Bar -->
    <div class="container">
        <div id="status-bar" class="status-bar">
            <div class="pulse"></div>
            <span id="status-text"></span>
        </div>
    </div>

    <!-- Pipeline Progress -->
    <div class="container">
        <div class="pipeline-progress" id="pipeline-progress">
            <div class="pipeline-step" id="pipe-analyze">
                <div class="pipe-icon">üîç</div>
                <div class="pipe-label">Analyze</div>
            </div>
            <div class="pipe-connector"></div>
            <div class="pipeline-step" id="pipe-generate">
                <div class="pipe-icon">‚ú®</div>
                <div class="pipe-label">Generate</div>
            </div>
            <div class="pipe-connector"></div>
            <div class="pipeline-step" id="pipe-verify">
                <div class="pipe-icon">üîé</div>
                <div class="pipe-label">Verify</div>
            </div>
            <div class="pipe-connector"></div>
            <div class="pipeline-step" id="pipe-refine">
                <div class="pipe-icon">üîß</div>
                <div class="pipe-label">Refine</div>
            </div>
        </div>
    </div>

    <!-- ============ STEP 1: Source Upload + Preview ============ -->
    <section class="container section-row">
        <div class="step-label"><span class="step-num">1</span> Source Image</div>
        <div class="row-grid">
            <div class="card">
                <div class="card-title">
                    <div class="dot purple"></div>
                    Upload Source
                </div>
                <div class="upload-zone" id="source-upload">
                    <div class="upload-icon">üì∑</div>
                    <div class="upload-text">Click or drag to upload</div>
                    <div class="upload-hint">The clothing from this image will be analyzed</div>
                    <input type="file" id="source-input" accept="image/*">
                </div>
                <button class="btn btn-primary" id="analyze-btn" disabled>
                    <div class="spinner"></div>
                    <span class="btn-text">üîç Analyze with Agentic Vision</span>
                </button>
            </div>
            <div class="card">
                <div class="card-title">
                    <div class="dot green"></div>
                    Source Preview
                </div>
                <div class="output-image-container" id="original-display">
                    <div class="output-placeholder">
                        <div class="icon">üñºÔ∏è</div>
                        <p>Source image preview</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============ STEP 2: Extracted Details ============ -->
    <section class="container">
        <div class="step-label"><span class="step-num">2</span> Extracted Details</div>
        <div class="card">
            <div class="card-title">
                <div class="dot green"></div>
                Analysis Results
                <button class="details-toggle" id="details-toggle" onclick="toggleDetails()">
                    ‚ñº Expand
                </button>
            </div>
            <pre class="details-panel collapsed"
                id="details-panel"><span class="placeholder">Analysis results will appear here after processing...</span></pre>
        </div>
    </section>

    <!-- ============ STEP 3: Target Upload + Generate ============ -->
    <section class="container section-row">
        <div class="step-label"><span class="step-num">3</span> Target Person & Generate</div>
        <div class="row-grid">
            <div class="card">
                <div class="card-title">
                    <div class="dot blue"></div>
                    Upload Target Person
                </div>
                <div class="upload-zone" id="target-upload">
                    <div class="upload-icon">üßë</div>
                    <div class="upload-text">Click or drag to upload</div>
                    <div class="upload-hint">This person will wear the analyzed clothing</div>
                    <input type="file" id="target-input" accept="image/*">
                </div>
                <div class="user-instructions-wrapper">
                    <label class="user-instructions-label" for="user-instructions">
                        <span class="label-icon">‚úçÔ∏è</span> Your Instructions <span
                            class="optional-tag">(Optional)</span>
                    </label>
                    <textarea id="user-instructions" class="user-instructions"
                        placeholder="e.g., White studio background, soft natural lighting, person facing camera, professional look, high quality photograph..."
                        rows="3"></textarea>
                    <div class="instructions-hint">üí° Yahan likho jo photo mein chahiye ‚Äî background, lighting, pose,
                        quality etc.</div>
                </div>
                <button class="btn btn-generate" id="generate-btn" disabled>
                    <div class="spinner"></div>
                    <span class="btn-text">‚ú® Generate with Agentic Pipeline</span>
                </button>
            </div>
            <div class="card">
                <div class="card-title">
                    <div class="dot pink"></div>
                    Generated Result
                    <!-- Accuracy Badge -->
                    <div class="accuracy-badge" id="accuracy-badge" style="display:none;">
                        <span class="accuracy-score" id="accuracy-score">--</span>
                        <span class="accuracy-label">Match</span>
                    </div>
                </div>
                <div class="output-image-container" id="generated-display">
                    <div class="output-placeholder">
                        <div class="icon">üé®</div>
                        <p>Generated image will appear here</p>
                    </div>
                </div>
                <button class="btn-download" id="download-btn">
                    ‚¨áÔ∏è Download Result
                </button>

                <!-- Comparison View -->
                <div class="comparison-section" id="comparison-section" style="display:none;">
                    <div class="card-title" style="margin-top:14px;">
                        <div class="dot orange"></div>
                        Source vs Result Comparison
                    </div>
                    <div class="comparison-grid">
                        <div class="comparison-item">
                            <div class="comparison-label">Source Dress</div>
                            <div class="comparison-img" id="compare-source"></div>
                        </div>
                        <div class="comparison-item">
                            <div class="comparison-label">Generated Result</div>
                            <div class="comparison-img" id="compare-generated"></div>
                        </div>
                    </div>
                </div>

                <!-- Corrections Log -->
                <div class="corrections-log" id="corrections-log" style="display:none;">
                    <div class="card-title" style="margin-top:14px;">
                        <div class="dot green"></div>
                        Verification & Corrections
                    </div>
                    <div class="corrections-content" id="corrections-content"></div>
                </div>

                <div class="generation-text" id="generation-text"></div>
                <!-- Prompt Debug -->
                <div class="prompt-debug" id="prompt-debug">
                    <button class="prompt-toggle" id="prompt-toggle" onclick="togglePrompt()">
                        üîç View Generation Prompt
                    </button>
                    <pre class="prompt-content" id="prompt-content"></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>Powered by <strong>Gemini 3 Flash</strong> (Vision) + <strong>Gemini 2.5 Flash</strong> (Generation +
            Verification)</p>
    </footer>

    <script src="/static/script.js"></script>

</body>

</html>